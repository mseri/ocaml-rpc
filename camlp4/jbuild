(library
 ((name rpclib_syntax)
  (public_name rpclib-camlp4.syntax)
  (modules (pa_rpc p4_rpc pa_module_conv))
  (libraries (rpclib type_conv result))
  (library_flags (-linkall))
  (preprocess (action (run camlp4orf ${<})))
  (optional)
  (wrapped false)
))

(library
 ((name idl)
  (public_name rpclib-camlp4.idl)
  (modules (p4_idl))
  (libraries (rpclib rpclib_syntax camlp4 result))
  (library_flags (-linkall))
  (preprocess (action (run camlp4orf ${<})))
  (optional)
  (wrapped false)
 ))

